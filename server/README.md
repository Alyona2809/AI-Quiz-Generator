# AI Quiz Generator - Backend Server

Backend сервер для приложения AI Quiz Generator, который генерирует квизы на основе текста или PDF файлов с использованием OpenAI API.

## Возможности

- Генерация квизов на основе текста с помощью OpenAI API
- Обработка PDF файлов и извлечение текста
- RESTful API с валидацией входных данных
- CORS поддержка для фронтенда
- Логирование запросов

## Установка

```bash
npm install
```

## Настройка

1. Создайте файл `.env` в корне папки `server`:

```env
OPENAI_API_KEY=your_openai_api_key_here
PORT=3001
```

2. Получите API ключ от OpenAI:
   - Зарегистрируйтесь на [platform.openai.com](https://platform.openai.com)
   - Создайте новый API ключ
   - Добавьте его в файл `.env`

## Запуск

```bash
# Разработка (с автоперезагрузкой)
npm run dev

# Продакшн
npm start
```

Сервер будет доступен по адресу `http://localhost:3001`

## API Endpoints

### POST /api/quiz/generate-quiz

Генерирует квиз на основе текста или PDF файла.

**Параметры:**

- `text` (string, optional) - текст для генерации квиза
- `file` (file, optional) - PDF файл для обработки

**Пример запроса:**

```bash
curl -X POST http://localhost:3001/api/quiz/generate-quiz \
  -F "text=Искусственный интеллект - это область компьютерных наук"
```

**Ответ:**

```json
{
  "success": true,
  "message": "Квиз успешно создан",
  "data": {
    "quiz": [
      {
        "id": 1,
        "question": "Что такое искусственный интеллект?",
        "options": [
          "Область компьютерных наук",
          "Тип программного обеспечения",
          "Метод шифрования данных",
          "Способ хранения информации"
        ],
        "correctAnswer": 0
      }
    ]
  }
}
```

## Структура проекта

```
src/
├── app.js              # Главный файл приложения
├── configs/            # Конфигурация сервера
│   └── serverConfig.js # Настройки Express и CORS
├── controllers/        # Контроллеры
│   └── quizController.js # Обработка запросов квизов
├── middlewares/        # Middleware функции
│   ├── fileUpload.js   # Загрузка файлов
│   ├── validateQuizInput.js # Валидация входных данных
│   ├── processPdfFile.js # Обработка PDF
│   ├── openaiService.js # Взаимодействие с OpenAI
│   └── removeHttpHeader.js # Удаление заголовков
├── routes/            # Маршруты API
│   ├── apiRouter.js   # Главный роутер API
│   ├── quizRouter.js  # Роуты для квизов
│   └── errorRouter.js # Обработка ошибок
└── utils/             # Утилиты
    └── formatResponse.js # Форматирование ответов
```

## Технологии

- **Node.js** - серверная платформа
- **Express.js** - веб-фреймворк
- **OpenAI API** - генерация квизов с помощью ИИ
- **Multer** - обработка загрузки файлов
- **pdf-parse** - извлечение текста из PDF
- **CORS** - поддержка кросс-доменных запросов
- **Morgan** - логирование HTTP запросов
- **dotenv** - управление переменными окружения

## Обработка ошибок

Сервер обрабатывает различные типы ошибок:

- **400** - Неверные входные данные
- **500** - Внутренние ошибки сервера
- **Ошибки OpenAI API** - проблемы с генерацией квизов
- **Ошибки обработки PDF** - проблемы с извлечением текста

## Безопасность

- API ключ OpenAI хранится в переменных окружения
- Валидация всех входных данных
- Ограничение типов загружаемых файлов (только PDF)
- CORS настройки для безопасности

## Разработка

Для разработки рекомендуется использовать `npm run dev` с nodemon для автоперезагрузки при изменениях.

## Лицензия

ISC
